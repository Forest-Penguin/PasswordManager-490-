<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>USB Setup</title>
</head>
<body>
    <h1>USB Setup</h1>
    <button id="select-usb">Select USB Drive</button>
    <p id="usb-status">Checking USB status...</p>
    <div id="password-setup" style="display: none;">
        <h2>Enter Master Password</h2>
        <input type="password" id="master-password" placeholder="Enter your master password" required>
        <button id="submit-password">Submit</button>
    </div>

    <script>
        const { ipcRenderer } = require('electron');

        document.getElementById('select-usb').addEventListener('click', () => {
            ipcRenderer.send('select-usb-drive');
        });

        ipcRenderer.on('usb-selected', (event, path) => {
            if (path) {
                document.getElementById('usb-status').textContent = `USB Drive Selected: ${path}`;
                document.getElementById('password-setup').style.display = 'block';
            } else {
                document.getElementById('usb-status').textContent = 'No USB Drive Selected. Please try again.';
            }
        });

        ipcRenderer.on('usb-error', (event, error) => {
            document.getElementById('usb-status').textContent = `Error: ${error}`;
        });

        document.getElementById('submit-password').addEventListener('click', () => {
            const password = document.getElementById('master-password').value;
            if (!password) {
                alert('Please enter a master password before submitting.');
                return;
            }

            ipcRenderer.send('initialize-usb', password);
        });

        ipcRenderer.on('setup-complete', (event, message) => {
            alert(message);
            ipcRenderer.send('load-login-page');
        });
    </script>
</body>
</html>
