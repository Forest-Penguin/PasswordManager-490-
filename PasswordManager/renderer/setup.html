<!-- renderer/setup.html -->
<!DOCTYPE html>
<html>
<head>
    <title>USB Setup</title>
</head>
<body>
    <h1>USB Setup</h1>
    <button id="select-usb">Select USB Drive</button>
    
    <!-- Master Password Input Field -->
    <input 
        type="password" 
        id="master-password" 
        placeholder="Enter Master Password" 
        style="margin-top: 20px; display: block;"
    >

    <button id="submit-password">Submit</button>

    <script>
        const { ipcRenderer } = require('electron');
        let usbPath = null;

        // Select USB drive
        document.getElementById('select-usb').onclick = () => {
            ipcRenderer.send('select-usb-drive');
            console.log("USB drive selection initiated.");
        };

        // Handle USB path response
        ipcRenderer.on('usb-selected', (event, path) => {
            usbPath = path;
            alert(`USB selected: ${path}`);
            console.log(`USB Path Set: ${usbPath}`);
        });

        ipcRenderer.on('usb-error', (event, message) => {
            alert(message);
            console.error(`USB Selection Error: ${message}`);
        });

        // Submit master password for USB initialization
        document.getElementById('submit-password').onclick = () => {
            const password = document.getElementById('master-password').value.trim();

            console.log("Submit button clicked.");
            console.log(`Entered Password: ${password}`);
            console.log(`USB Path: ${usbPath}`);

            if (!usbPath) {
                alert("Please select a USB drive first.");
                return;
            }
            
            if (!password) {
                alert("Please enter a master password.");
                return;
            }

            // Send data to backend for USB initialization
            ipcRenderer.send('initialize-usb', { password, usbPath });
            console.log("Master password and USB path sent to backend.");
        };

        // Confirmation of USB initialization
        ipcRenderer.on('usb-initialized', (event, message) => {
            alert(message);
            console.log(`Initialization Message: ${message}`);
        });
    </script>
</body>
</html>
