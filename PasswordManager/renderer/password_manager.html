<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Password Manager</title>
</head>
<body>
    <h1>Password Manager</h1>
    <button id="add-password">Add New Password</button>
    <div id="passwords"></div>

    <div id="password-form" style="display: none;">
        <input id="service" placeholder="Service">
        <input id="username" placeholder="Username">
        <input id="password" placeholder="Password">
        <button id="generate-password">Generate Password</button>
        <button id="save-password">Save Password</button>
    </div>

    <script>
        const { ipcRenderer } = require('electron');

        // Show the password form to add a new password
        document.getElementById('add-password').onclick = () => {
            document.getElementById('password-form').style.display = 'block';
        };

        // Request password generation from the backend
        document.getElementById('generate-password').onclick = () => {
            ipcRenderer.send('generate-password');
        };

        // Save the new password to the backend
        document.getElementById('save-password').onclick = () => {
            const service = document.getElementById('service').value;
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            ipcRenderer.send('save-password', { service, username, password });
        };

        // Display generated password in the input field
        ipcRenderer.on('password-generated', (event, generatedPassword) => {
            document.getElementById('password').value = generatedPassword;
        });

        // Handle confirmation of password save
        ipcRenderer.on('password-saved', (event, message) => {
            alert(`Password saved: ${message}`);
            document.getElementById('password-form').style.display = 'none';
        });

        // Display saved passwords retrieved from the backend
        ipcRenderer.on('display-passwords', (event, passwords) => {
            const passwordsDiv = document.getElementById('passwords');
            passwordsDiv.innerHTML = passwords.map(password => `
                <div>
                    <strong>Service:</strong> ${password.service} <br>
                    <strong>Username:</strong> ${password.username} <br>
                    <strong>Password:</strong> ${password.password}
                    <button onclick="deletePassword('${password.id}')">Delete</button>
                </div>
            `).join('');
        });

        // Request deletion of a password by ID
        function deletePassword(id) {
            ipcRenderer.send('delete-password', id);
        }

        // Handle confirmation of password deletion
        ipcRenderer.on('password-deleted', (event, message) => {
            alert(`Password deleted: ${message}`);
            ipcRenderer.send('load-passwords'); // Refresh password list
        });

        // Load all passwords on page load
        ipcRenderer.send('load-passwords');
    </script>
</body>
</html>
